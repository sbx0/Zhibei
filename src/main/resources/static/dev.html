<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
    <title>Zhibei Dev</title>
</head>
<body>
<div style="height: 30px">
    <h2 style="text-align: left">
        Zhibei Dev
    </h2>
</div>
<ul>
    <li>
        <h3>Test</h3>
    </li>
    <div style="overflow:auto;max-height: 250px;">
        <form action="/trade/base/recharge" method="get">
            <button>Get Trade No</button>
        </form>
        <input id="trade-no" name="tradeNo"/>
        <button id="submit-btn">Pay</button>
    </div>
</ul>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<hr/>
<div style="text-align:center;">
    <a href="login.html">Login</a>
    |
    <a href="index.html">Index</a>
    |
    <a href="https://sbx0.cn/" target="_blank">SPA by React</a>
    |
    <a href="https://github.com/sbx0/Zhibei" target="_blank">GitHub</a>
    |
    <a href="https://blog.sbx0.cn/" target="_blank">Blog</a>
    <hr/>
    <small>sbx0</small>
    <br/>
    <small>2019 - 2020</small>
    <br/>
    <small>Power By Spring Boot</small>
</div>
</body>
<script>
    window.onload = () => {
        let btn = document.getElementById('submit-btn');
        btn.onclick = () => {
            let tradeNo = document.getElementById('trade-no').value;
            let params = {
                'tradeNo': tradeNo
            }
            const formBody = Object.keys(params).map(key => encodeURIComponent(key) + '=' + encodeURIComponent(params[key])).join('&');
            fetch('/alipay/pay', {
                method: 'post',
                body: formBody,
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',
                    'Access-Control-Allow-Origin': '*'
                }
            }).then((response) => response.json()).then((json) => {
                console.log(json);
                document.write(json.object)
            }).finally(() => {
                return false;
            })
        }
    }
</script>
</html>